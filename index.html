<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Bible Parallel Viewer</title>
  <style>
    :root {
      --bg: #0f172a;
      --panel: #111827;
      --accent: #38bdf8;
      --text: #e2e8f0;
      --muted: #94a3b8;
      --border: #1f2937;
      --shadow: 0 10px 30px rgba(0, 0, 0, 0.35);
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: "Inter", "Segoe UI", system-ui, sans-serif;
      background: radial-gradient(circle at 20% 20%, rgba(56, 189, 248, 0.1), transparent 35%),
                  radial-gradient(circle at 80% 10%, rgba(14, 165, 233, 0.08), transparent 30%),
                  var(--bg);
      color: var(--text);
      display: flex;
      min-height: 100vh;
    }
    aside {
      width: 320px;
      background: var(--panel);
      border-right: 1px solid var(--border);
      padding: 18px;
      box-shadow: var(--shadow);
      position: sticky;
      top: 0;
      height: 100vh;
      overflow-y: auto;
    }
    h1 {
      margin: 0 0 12px;
      font-size: 20px;
      letter-spacing: 0.5px;
      color: #e2e8f0;
    }
    .section-title {
      margin: 14px 0 6px;
      color: var(--muted);
      font-size: 12px;
      letter-spacing: 1px;
      text-transform: uppercase;
    }
    .book {
      border: 1px solid var(--border);
      border-radius: 10px;
      margin-bottom: 10px;
      background: rgba(255, 255, 255, 0.02);
    }
    .book-header {
      padding: 10px 12px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      cursor: pointer;
      transition: background 0.2s ease;
    }
    .book-header:hover { background: rgba(56, 189, 248, 0.08); }
    .book-title { font-weight: 600; color: #e2e8f0; }
    .chapter-list {
      display: none;
      padding: 10px 12px 12px;
      border-top: 1px solid var(--border);
      gap: 8px;
      flex-wrap: wrap;
    }
    .chapter-list.open { display: flex; }
    .chapter {
      padding: 6px 10px;
      border: 1px solid var(--border);
      border-radius: 8px;
      cursor: pointer;
      color: var(--muted);
      background: rgba(255, 255, 255, 0.02);
      transition: all 0.15s ease;
      font-size: 13px;
    }
    .chapter:hover { color: #e2e8f0; border-color: var(--accent); }
    main {
      flex: 1;
      padding: 22px;
      overflow-y: auto;
    }
    .meta {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      gap: 12px;
      flex-wrap: wrap;
      margin-bottom: 12px;
    }
    .meta h2 { margin: 0; font-size: 18px; }
    .meta .subtitle { color: var(--muted); font-size: 14px; }
    .grid {
      display: flex;
      flex-direction: column;
      gap: 14px;
    }
    .header-row {
      display: grid;
      grid-template-columns: 50px 1fr 1fr;
      gap: 14px;
      margin-bottom: 10px;
    }
    .header-row h3 {
      margin: 0;
      font-size: 16px;
      color: var(--accent);
      padding: 10px;
    }
    .header-row .v-num-header {
      color: var(--accent);
      font-size: 14px;
      font-weight: bold;
      text-align: center;
      padding: 10px 0;
    }
    .verse-row {
      display: grid;
      grid-template-columns: 50px 1fr 1fr;
      gap: 14px;
      padding: 12px 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.04);
      align-items: start;
    }
    .verse-row:last-child { border-bottom: none; }
    .v-num {
      color: var(--muted);
      font-size: 13px;
      text-align: center;
      font-weight: 600;
      padding-top: 2px;
    }
    .v-text {
      line-height: 1.65;
      padding: 0 12px;
      background: transparent;
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      padding: 12px;
    }
    .col {
      background: transparent;
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      padding: 16px;
      box-shadow: var(--shadow);
    }
    .col h3 { margin: 0 0 10px; font-size: 16px; color: var(--accent); }
    .empty { color: var(--muted); text-align: center; padding: 30px 0; }
    
    footer {
      margin-top: 40px;
      padding: 20px;
      text-align: center;
      color: var(--muted);
      font-size: 13px;
      border-top: 1px solid var(--border);
      line-height: 1.6;
    }
    footer a {
      color: var(--accent);
      text-decoration: none;
    }
    footer a:hover {
      text-decoration: underline;
    }
    
    .chinese-toggle {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
      font-size: 13px;
      color: var(--muted);
    }
    .toggle-switch {
      position: relative;
      width: 50px;
      height: 24px;
      background: var(--border);
      border-radius: 12px;
      cursor: pointer;
      transition: background 0.3s;
    }
    .toggle-switch.active {
      background: var(--accent);
    }
    .toggle-slider {
      position: absolute;
      top: 2px;
      left: 2px;
      width: 20px;
      height: 20px;
      background: white;
      border-radius: 50%;
      transition: transform 0.3s;
    }
    .toggle-switch.active .toggle-slider {
      transform: translateX(26px);
    }
    
    .bookmark-btn {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      padding: 8px 15px;
      background: var(--panel);
      color: var(--accent);
      border: 1px solid var(--border);
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      margin-left: 15px;
      transition: all 0.2s;
    }
    .bookmark-btn:hover {
      background: var(--accent);
      color: #0f172a;
    }
    .bookmark-btn.bookmarked {
      background: var(--accent);
      color: #0f172a;
    }
    .bookmarks-section {
      margin-top: 20px;
      padding-top: 20px;
      border-top: 1px solid var(--border);
    }
    .color-controls {
      margin-bottom: 20px;
      padding-bottom: 20px;
      border-bottom: 1px solid var(--border);
    }
    .color-control {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 12px;
      font-size: 13px;
      color: var(--muted);
    }
    .color-control label {
      flex: 1;
    }
    .color-control input[type="color"] {
      width: 50px;
      height: 30px;
      border: 1px solid var(--border);
      border-radius: 6px;
      cursor: pointer;
      background: transparent;
    }
    .bookmark-item {
      padding: 10px;
      margin: 5px 0;
      background: var(--panel);
      border-radius: 6px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      cursor: pointer;
      transition: background 0.2s;
    }
    .bookmark-item:hover {
      background: rgba(56, 189, 248, 0.1);
    }
    .bookmark-info {
      flex: 1;
    }
    .bookmark-title {
      font-size: 14px;
      color: #e2e8f0;
      margin-bottom: 3px;
    }
    .bookmark-date {
      font-size: 11px;
      color: var(--muted);
    }
    .bookmark-delete {
      padding: 5px 10px;
      background: rgba(239, 68, 68, 0.2);
      color: #ef4444;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 12px;
      transition: background 0.2s;
    }
    .bookmark-delete:hover {
      background: rgba(239, 68, 68, 0.3);
    }
    
    .chapter-nav {
      position: fixed;
      bottom: 20px;
      right: 20px;
      display: none;
      gap: 10px;
      z-index: 100;
    }
    .chapter-nav.active {
      display: flex;
    }
    .nav-btn {
      padding: 12px 20px;
      background: var(--panel);
      color: #e2e8f0;
      border: 1px solid var(--border);
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      transition: all 0.2s;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .nav-btn:hover:not(:disabled) {
      background: var(--accent);
      color: #0f172a;
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
    }
    .nav-btn:disabled {
      opacity: 0.3;
      cursor: not-allowed;
    }
    
    .chapter-image {
      width: 100%;
      max-width: 100%;
      margin: 0 0 30px 0;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: var(--shadow);
      background: var(--panel);
    }
    .chapter-image img {
      width: 100%;
      height: auto;
      display: block;
      max-height: 400px;
      object-fit: cover;
    }
    .chapter-image .image-caption {
      padding: 12px;
      text-align: center;
      color: var(--muted);
      font-size: 0.9em;
      background: rgba(0, 0, 0, 0.2);
    }
    
    @media (max-width: 900px) {
      body { flex-direction: column; }
      aside {
        position: relative;
        width: 100%;
        height: auto;
        border-right: none;
        border-bottom: 1px solid var(--border);
      }
      main { padding: 16px; }
      .grid { grid-template-columns: 1fr; }
      .meta { gap: 6px; }
    }
  </style>
</head>
<body>
  <aside>
    <h1>Parallel Bible</h1>
    <div class="color-controls">
      <div class="section-title">Appearance</div>
      <div class="color-control">
        <label for="bg-color">Background</label>
        <input type="color" id="bg-color" value="#0f172a">
      </div>
      <div class="color-control">
        <label for="text-color">Text Color</label>
        <input type="color" id="text-color" value="#e2e8f0">
      </div>
    </div>
    <div class="bookmarks-section">
      <div class="section-title">Bookmarks</div>
      <div id="bookmarks-list"></div>
    </div>
    <div class="section-title">Old Testament</div>
    <div id="old-testament"></div>
    <div class="section-title">New Testament</div>
    <div id="new-testament"></div>
  </aside>
  <main>
    <div id="chapter-image-container" class="chapter-image" style="display: none;">
      <img id="chapter-image" src="" alt="Chapter illustration">
      <div class="image-caption" id="image-caption">Loading image...</div>
    </div>
    <div class="meta">
      <div style="display: flex; align-items: center;">
        <h2 id="heading">Select a chapter</h2>
        <button class="bookmark-btn" id="bookmark-btn" onclick="toggleBookmark()" style="display: none;">
          <span id="bookmark-icon">☆</span>
          <span id="bookmark-text">Bookmark</span>
        </button>
      </div>
      <div class="subtitle" id="subheading"></div>
    </div>
    <div class="grid">
      <div class="header-row">
        <div class="v-num-header">Verse</div>
        <div>
          <h3 id="cuv-title">Chinese Union Version (和合本简体)</h3>
          <div class="chinese-toggle">
            <span>繁体</span>
            <div class="toggle-switch active" id="chinese-toggle" onclick="toggleChinese()">
              <div class="toggle-slider"></div>
            </div>
            <span>简体</span>
          </div>
        </div>
        <h3>New International Version (NIV)</h3>
      </div>
      <div id="verses-container"></div>
    </div>
    <footer>
      <p>&copy; 2026 Parallel Bible Viewer - Leo Liu, PhD. All rights reserved.</p>
      <p>Bible translations: Chinese Union Version (CUV) 和合本 (简体/繁体) and New International Version (NIV)</p>
      <p>Scripture taken from <a href="https://bolls.life" target="_blank">Bolls.life API</a></p>
      <p>For educational and personal study purposes only.</p>
    </footer>
  </main>

  <div class="chapter-nav" id="chapter-nav">
    <button class="nav-btn" id="prev-btn" onclick="navigatePrevChapter()">
      <span>←</span>
      <span>Previous</span>
    </button>
    <button class="nav-btn" id="next-btn" onclick="navigateNextChapter()">
      <span>Next</span>
      <span>→</span>
    </button>
  </div>

  <script>
    // Color controls
    function initColorControls() {
      const bgColor = document.getElementById('bg-color');
      const textColor = document.getElementById('text-color');
      
      // Load saved colors from localStorage
      const savedBgColor = localStorage.getItem('bgColor');
      const savedTextColor = localStorage.getItem('textColor');
      
      if (savedBgColor) {
        bgColor.value = savedBgColor;
        document.documentElement.style.setProperty('--bg', savedBgColor);
      }
      
      if (savedTextColor) {
        textColor.value = savedTextColor;
        document.documentElement.style.setProperty('--text', savedTextColor);
      }
      
      // Add event listeners
      bgColor.addEventListener('input', (e) => {
        const color = e.target.value;
        document.documentElement.style.setProperty('--bg', color);
        localStorage.setItem('bgColor', color);
      });
      
      textColor.addEventListener('input', (e) => {
        const color = e.target.value;
        document.documentElement.style.setProperty('--text', color);
        localStorage.setItem('textColor', color);
      });
    }
    
    // Initialize color controls on page load
    initColorControls();
    
    // Using bolls.life API (free, no authentication required)
    // CUV (Chinese Union Version) and NIV (New International Version)
    
    // State for Chinese character preference
    let useSimplifiedChinese = true;
    let currentBook = null;
    let currentChapter = null;
    
    // Bookmark management
    let bookmarks = JSON.parse(localStorage.getItem('bibleBookmarks') || '[]');
    
    function saveBookmarks() {
      localStorage.setItem('bibleBookmarks', JSON.stringify(bookmarks));
      renderBookmarks();
    }
    
    function toggleBookmark() {
      if (!currentBook || !currentChapter) return;
      
      const bookmarkKey = `${currentBook.name}-${currentChapter}`;
      const existingIndex = bookmarks.findIndex(b => b.key === bookmarkKey);
      
      if (existingIndex >= 0) {
        // Remove bookmark
        bookmarks.splice(existingIndex, 1);
      } else {
        // Add bookmark
        bookmarks.push({
          key: bookmarkKey,
          bookName: currentBook.name,
          chineseName: currentBook.cname,
          chapter: currentChapter,
          date: new Date().toISOString(),
          bookNum: currentBook.bookNum
        });
      }
      
      saveBookmarks();
      updateBookmarkButton();
    }
    
    function deleteBookmark(bookmarkKey) {
      bookmarks = bookmarks.filter(b => b.key !== bookmarkKey);
      saveBookmarks();
      if (currentBook && currentChapter) {
        updateBookmarkButton();
      }
    }
    
    function renderBookmarks() {
      const bookmarksList = document.getElementById('bookmarks-list');
      if (bookmarks.length === 0) {
        bookmarksList.innerHTML = '<div style="color: var(--muted); font-size: 12px; padding: 10px;">No bookmarks yet</div>';
        return;
      }
      
      bookmarksList.innerHTML = bookmarks.map(bookmark => {
        const date = new Date(bookmark.date);
        const dateStr = date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
        return `
          <div class="bookmark-item">
            <div class="bookmark-info" onclick="loadBookmark('${bookmark.key}')">
              <div class="bookmark-title">${bookmark.chineseName} ${bookmark.bookName} ${bookmark.chapter}</div>
              <div class="bookmark-date">${dateStr}</div>
            </div>
            <button class="bookmark-delete" onclick="event.stopPropagation(); deleteBookmark('${bookmark.key}')">Delete</button>
          </div>
        `;
      }).join('');
    }
    
    function loadBookmark(bookmarkKey) {
      const bookmark = bookmarks.find(b => b.key === bookmarkKey);
      if (!bookmark) return;
      
      const book = bibleData.books.find(b => b.name === bookmark.bookName);
      if (book) {
        loadChapter(book, bookmark.chapter);
      }
    }
    
    function updateBookmarkButton() {
      const bookmarkBtn = document.getElementById('bookmark-btn');
      const bookmarkIcon = document.getElementById('bookmark-icon');
      const bookmarkText = document.getElementById('bookmark-text');
      
      if (!currentBook || !currentChapter) {
        bookmarkBtn.style.display = 'none';
        return;
      }
      
      bookmarkBtn.style.display = 'inline-flex';
      const bookmarkKey = `${currentBook.name}-${currentChapter}`;
      const isBookmarked = bookmarks.some(b => b.key === bookmarkKey);
      
      if (isBookmarked) {
        bookmarkBtn.classList.add('bookmarked');
        bookmarkIcon.textContent = '★';
        bookmarkText.textContent = 'Bookmarked';
      } else {
        bookmarkBtn.classList.remove('bookmarked');
        bookmarkIcon.textContent = '☆';
        bookmarkText.textContent = 'Bookmark';
      }
    }
    
    // Chapter navigation functions
    function updateNavigationButtons() {
      const navContainer = document.getElementById('chapter-nav');
      const prevBtn = document.getElementById('prev-btn');
      const nextBtn = document.getElementById('next-btn');
      
      if (!currentBook || !currentChapter) {
        navContainer.classList.remove('active');
        return;
      }
      
      navContainer.classList.add('active');
      
      // Check if there's a previous chapter
      const hasPrev = currentChapter > 1 || bibleData.books.findIndex(b => b.name === currentBook.name) > 0;
      prevBtn.disabled = !hasPrev;
      
      // Check if there's a next chapter
      const currentBookIndex = bibleData.books.findIndex(b => b.name === currentBook.name);
      const hasNext = currentChapter < currentBook.chapters || currentBookIndex < bibleData.books.length - 1;
      nextBtn.disabled = !hasNext;
    }
    
    function navigatePrevChapter() {
      if (!currentBook || !currentChapter) return;
      
      if (currentChapter > 1) {
        // Previous chapter in same book
        loadChapter(currentBook, currentChapter - 1);
      } else {
        // Last chapter of previous book
        const currentBookIndex = bibleData.books.findIndex(b => b.name === currentBook.name);
        if (currentBookIndex > 0) {
          const prevBook = bibleData.books[currentBookIndex - 1];
          loadChapter(prevBook, prevBook.chapters);
        }
      }
    }
    
    function navigateNextChapter() {
      if (!currentBook || !currentChapter) return;
      
      if (currentChapter < currentBook.chapters) {
        // Next chapter in same book
        loadChapter(currentBook, currentChapter + 1);
      } else {
        // First chapter of next book
        const currentBookIndex = bibleData.books.findIndex(b => b.name === currentBook.name);
        if (currentBookIndex < bibleData.books.length - 1) {
          const nextBook = bibleData.books[currentBookIndex + 1];
          loadChapter(nextBook, 1);
        }
      }
    }
    
    // Toggle between traditional and simplified Chinese
    function toggleChinese() {
      useSimplifiedChinese = !useSimplifiedChinese;
      const toggle = document.getElementById('chinese-toggle');
      const title = document.getElementById('cuv-title');
      
      if (useSimplifiedChinese) {
        toggle.classList.add('active');
        title.textContent = 'Chinese Union Version (和合本简体)';
      } else {
        toggle.classList.remove('active');
        title.textContent = 'Chinese Union Version (和合本繁体)';
      }
      
      // Reload current chapter if one is loaded
      if (currentBook && currentChapter) {
        loadChapter(currentBook, currentChapter);
      }
    }
    
    // Chapter titles for notable chapters
    const chapterTitles = {
      "Genesis-1": {en: "The Creation", zh: "创造天地"},
      "Genesis-2": {en: "Adam and Eve", zh: "亚当与夏娃"},
      "Genesis-3": {en: "The Fall", zh: "人类的堕落"},
      "Genesis-6": {en: "Noah and the Flood", zh: "挪亚与洪水"},
      "Genesis-22": {en: "Abraham's Test", zh: "亚伯拉罕的考验"},
      "Exodus-3": {en: "The Burning Bush", zh: "燃烧的荆棘"},
      "Exodus-12": {en: "The Passover", zh: "逾越节"},
      "Exodus-14": {en: "Crossing the Red Sea", zh: "过红海"},
      "Exodus-20": {en: "The Ten Commandments", zh: "十诫"},
      "Leviticus-19": {en: "Love Your Neighbor", zh: "爱人如己"},
      "Deuteronomy-6": {en: "The Shema", zh: "示玛篇"},
      "Joshua-1": {en: "Be Strong and Courageous", zh: "刚强壮胆"},
      "Joshua-6": {en: "The Fall of Jericho", zh: "耶利哥城陷落"},
      "Ruth-1": {en: "Ruth's Loyalty", zh: "路得的忠诚"},
      "1 Samuel-17": {en: "David and Goliath", zh: "大卫与歌利亚"},
      "2 Samuel-7": {en: "God's Covenant with David", zh: "神与大卫立约"},
      "1 Kings-3": {en: "Solomon's Wisdom", zh: "所罗门的智慧"},
      "Esther-4": {en: "For Such a Time as This", zh: "为现今的机会"},
      "Job-1": {en: "Job's First Test", zh: "约伯的试炼"},
      "Job-38": {en: "The Lord Answers Job", zh: "耶和华回答约伯"},
      "Psalm-1": {en: "The Way of the Righteous", zh: "义人的道路"},
      "Psalm-23": {en: "The Lord is My Shepherd", zh: "耶和华是我的牧者"},
      "Psalm-51": {en: "A Prayer for Forgiveness", zh: "认罪悔改的祷告"},
      "Psalm-91": {en: "Under His Wings", zh: "在祂翅膀荫下"},
      "Psalm-119": {en: "The Word of God", zh: "神的话语"},
      "Proverbs-3": {en: "Trust in the Lord", zh: "信靠耶和华"},
      "Proverbs-31": {en: "The Virtuous Woman", zh: "才德的妇人"},
      "Ecclesiastes-3": {en: "A Time for Everything", zh: "万事都有定期"},
      "Song of Solomon-2": {en: "Love's Delight", zh: "爱的喜悦"},
      "Isaiah-9": {en: "A Child is Born", zh: "有一婴孩为我们而生"},
      "Isaiah-53": {en: "The Suffering Servant", zh: "受苦的仆人"},
      "Jeremiah-29": {en: "Plans to Prosper You", zh: "赐平安的意念"},
      "Ezekiel-37": {en: "The Valley of Dry Bones", zh: "枯骨复活"},
      "Daniel-3": {en: "The Fiery Furnace", zh: "火窑中的拯救"},
      "Daniel-6": {en: "Daniel in the Lions' Den", zh: "但以理在狮子坑中"},
      "Jonah-2": {en: "Jonah's Prayer", zh: "约拿的祷告"},
      "Matthew-5": {en: "The Sermon on the Mount", zh: "登山宝训"},
      "Matthew-6": {en: "The Lord's Prayer", zh: "主祷文"},
      "Matthew-28": {en: "The Great Commission", zh: "大使命"},
      "Mark-16": {en: "The Resurrection", zh: "耶稣复活"},
      "Luke-1": {en: "The Birth Foretold", zh: "预言耶稣降生"},
      "Luke-2": {en: "The Birth of Jesus", zh: "耶稣降生"},
      "Luke-15": {en: "The Prodigal Son", zh: "浪子回头"},
      "John-1": {en: "The Word Became Flesh", zh: "道成肉身"},
      "John-3": {en: "You Must Be Born Again", zh: "重生之道"},
      "John-11": {en: "Lazarus Raised from the Dead", zh: "拉撒路复活"},
      "John-14": {en: "I Am the Way", zh: "我是道路"},
      "John-15": {en: "The Vine and the Branches", zh: "葡萄树与枝子"},
      "Acts-1": {en: "The Ascension", zh: "耶稣升天"},
      "Acts-2": {en: "Pentecost", zh: "五旬节圣灵降临"},
      "Acts-9": {en: "Saul's Conversion", zh: "扫罗悔改"},
      "Romans-3": {en: "Justified by Faith", zh: "因信称义"},
      "Romans-5": {en: "Peace with God", zh: "与神和好"},
      "Romans-8": {en: "More Than Conquerors", zh: "得胜有余"},
      "Romans-12": {en: "Living Sacrifices", zh: "献上活祭"},
      "1 Corinthians-13": {en: "Love Never Fails", zh: "爱是永不止息"},
      "1 Corinthians-15": {en: "The Resurrection Chapter", zh: "复活的真理"},
      "2 Corinthians-5": {en: "New Creation", zh: "新造的人"},
      "Galatians-5": {en: "Fruit of the Spirit", zh: "圣灵的果子"},
      "Ephesians-2": {en: "Saved by Grace", zh: "因恩典得救"},
      "Ephesians-6": {en: "The Armor of God", zh: "神的全副军装"},
      "Philippians-2": {en: "The Mind of Christ", zh: "基督的心"},
      "Philippians-4": {en: "Rejoice in the Lord", zh: "靠主喜乐"},
      "Colossians-3": {en: "Set Your Minds on Things Above", zh: "思念天上的事"},
      "1 Thessalonians-4": {en: "The Lord's Coming", zh: "主的再来"},
      "1 Timothy-6": {en: "Fight the Good Fight", zh: "打那美好的仗"},
      "2 Timothy-3": {en: "All Scripture is God-Breathed", zh: "圣经是神所默示的"},
      "Hebrews-11": {en: "The Hall of Faith", zh: "信心的见证人"},
      "Hebrews-12": {en: "The Race Set Before Us", zh: "奔那摆在前头的路程"},
      "James-1": {en: "Trials and Temptations", zh: "试炼与试探"},
      "James-2": {en: "Faith Without Works is Dead", zh: "信心与行为"},
      "1 Peter-2": {en: "Living Stones", zh: "活石"},
      "1 John-4": {en: "God is Love", zh: "神就是爱"},
      "Revelation-1": {en: "John's Vision", zh: "约翰的异象"},
      "Revelation-21": {en: "The New Heaven and New Earth", zh: "新天新地"},
      "Revelation-22": {en: "Come, Lord Jesus", zh: "主耶稣啊，我愿你来"}
    };
    
    function getChapterTitle(bookName, chapterNum) {
      const key = `${bookName}-${chapterNum}`;
      return chapterTitles[key] || null;
    }
    
    // Bible books structure with bolls.life book IDs (1-66)
    const bibleData = {
      books: [
        // Old Testament
        { name: "Genesis", cname: "创世记", id: "genesis", bookNum: 1, testament: "old", chapters: 50 },
        { name: "Exodus", cname: "出埃及记", id: "exodus", bookNum: 2, testament: "old", chapters: 40 },
        { name: "Leviticus", cname: "利未记", id: "leviticus", bookNum: 3, testament: "old", chapters: 27 },
        { name: "Numbers", cname: "民数记", id: "numbers", bookNum: 4, testament: "old", chapters: 36 },
        { name: "Deuteronomy", cname: "申命记", id: "deuteronomy", bookNum: 5, testament: "old", chapters: 34 },
        { name: "Joshua", cname: "约书亚记", id: "joshua", bookNum: 6, testament: "old", chapters: 24 },
        { name: "Judges", cname: "士师记", id: "judges", bookNum: 7, testament: "old", chapters: 21 },
        { name: "Ruth", cname: "路得记", id: "ruth", bookNum: 8, testament: "old", chapters: 4 },
        { name: "1 Samuel", cname: "撒母耳记上", id: "1samuel", bookNum: 9, testament: "old", chapters: 31 },
        { name: "2 Samuel", cname: "撒母耳记下", id: "2samuel", bookNum: 10, testament: "old", chapters: 24 },
        { name: "1 Kings", cname: "列王纪上", id: "1kings", bookNum: 11, testament: "old", chapters: 22 },
        { name: "2 Kings", cname: "列王纪下", id: "2kings", bookNum: 12, testament: "old", chapters: 25 },
        { name: "1 Chronicles", cname: "历代志上", id: "1chronicles", bookNum: 13, testament: "old", chapters: 29 },
        { name: "2 Chronicles", cname: "历代志下", id: "2chronicles", bookNum: 14, testament: "old", chapters: 36 },
        { name: "Ezra", cname: "以斯拉记", id: "ezra", bookNum: 15, testament: "old", chapters: 10 },
        { name: "Nehemiah", cname: "尼希米记", id: "nehemiah", bookNum: 16, testament: "old", chapters: 13 },
        { name: "Esther", cname: "以斯帖记", id: "esther", bookNum: 17, testament: "old", chapters: 10 },
        { name: "Job", cname: "约伯记", id: "job", bookNum: 18, testament: "old", chapters: 42 },
        { name: "Psalms", cname: "诗篇", id: "psalms", bookNum: 19, testament: "old", chapters: 150 },
        { name: "Proverbs", cname: "箴言", id: "proverbs", bookNum: 20, testament: "old", chapters: 31 },
        { name: "Ecclesiastes", cname: "传道书", id: "ecclesiastes", bookNum: 21, testament: "old", chapters: 12 },
        { name: "Song of Solomon", cname: "雅歌", id: "songofsolomon", bookNum: 22, testament: "old", chapters: 8 },
        { name: "Isaiah", cname: "以赛亚书", id: "isaiah", bookNum: 23, testament: "old", chapters: 66 },
        { name: "Jeremiah", cname: "耶利米书", id: "jeremiah", bookNum: 24, testament: "old", chapters: 52 },
        { name: "Lamentations", cname: "耶利米哀歌", id: "lamentations", bookNum: 25, testament: "old", chapters: 5 },
        { name: "Ezekiel", cname: "以西结书", id: "ezekiel", bookNum: 26, testament: "old", chapters: 48 },
        { name: "Daniel", cname: "但以理书", id: "daniel", bookNum: 27, testament: "old", chapters: 12 },
        { name: "Hosea", cname: "何西阿书", id: "hosea", bookNum: 28, testament: "old", chapters: 14 },
        { name: "Joel", cname: "约珥书", id: "joel", bookNum: 29, testament: "old", chapters: 3 },
        { name: "Amos", cname: "阿摩司书", id: "amos", bookNum: 30, testament: "old", chapters: 9 },
        { name: "Obadiah", cname: "俄巴底亚书", id: "obadiah", bookNum: 31, testament: "old", chapters: 1 },
        { name: "Jonah", cname: "约拿书", id: "jonah", bookNum: 32, testament: "old", chapters: 4 },
        { name: "Micah", cname: "弥迦书", id: "micah", bookNum: 33, testament: "old", chapters: 7 },
        { name: "Nahum", cname: "那鸿书", id: "nahum", bookNum: 34, testament: "old", chapters: 3 },
        { name: "Habakkuk", cname: "哈巴谷书", id: "habakkuk", bookNum: 35, testament: "old", chapters: 3 },
        { name: "Zephaniah", cname: "西番雅书", id: "zephaniah", bookNum: 36, testament: "old", chapters: 3 },
        { name: "Haggai", cname: "哈该书", id: "haggai", bookNum: 37, testament: "old", chapters: 2 },
        { name: "Zechariah", cname: "撒迦利亚书", id: "zechariah", bookNum: 38, testament: "old", chapters: 14 },
        { name: "Malachi", cname: "玛拉基书", id: "malachi", bookNum: 39, testament: "old", chapters: 4 },
        // New Testament
        { name: "Matthew", cname: "马太福音", id: "matthew", bookNum: 40, testament: "new", chapters: 28 },
        { name: "Mark", cname: "马可福音", id: "mark", bookNum: 41, testament: "new", chapters: 16 },
        { name: "Luke", cname: "路加福音", id: "luke", bookNum: 42, testament: "new", chapters: 24 },
        { name: "John", cname: "约翰福音", id: "john", bookNum: 43, testament: "new", chapters: 21 },
        { name: "Acts", cname: "使徒行传", id: "acts", bookNum: 44, testament: "new", chapters: 28 },
        { name: "Romans", cname: "罗马书", id: "romans", bookNum: 45, testament: "new", chapters: 16 },
        { name: "1 Corinthians", cname: "哥林多前书", id: "1corinthians", bookNum: 46, testament: "new", chapters: 16 },
        { name: "2 Corinthians", cname: "哥林多后书", id: "2corinthians", bookNum: 47, testament: "new", chapters: 13 },
        { name: "Galatians", cname: "加拉太书", id: "galatians", bookNum: 48, testament: "new", chapters: 6 },
        { name: "Ephesians", cname: "以弗所书", id: "ephesians", bookNum: 49, testament: "new", chapters: 6 },
        { name: "Philippians", cname: "腓立比书", id: "philippians", bookNum: 50, testament: "new", chapters: 4 },
        { name: "Colossians", cname: "歌罗西书", id: "colossians", bookNum: 51, testament: "new", chapters: 4 },
        { name: "1 Thessalonians", cname: "帖撒罗尼迦前书", id: "1thessalonians", bookNum: 52, testament: "new", chapters: 5 },
        { name: "2 Thessalonians", cname: "帖撒罗尼迦后书", id: "2thessalonians", bookNum: 53, testament: "new", chapters: 3 },
        { name: "1 Timothy", cname: "提摩太前书", id: "1timothy", bookNum: 54, testament: "new", chapters: 6 },
        { name: "2 Timothy", cname: "提摩太后书", id: "2timothy", bookNum: 55, testament: "new", chapters: 4 },
        { name: "Titus", cname: "提多书", id: "titus", bookNum: 56, testament: "new", chapters: 3 },
        { name: "Philemon", cname: "腓利门书", id: "philemon", bookNum: 57, testament: "new", chapters: 1 },
        { name: "Hebrews", cname: "希伯来书", id: "hebrews", bookNum: 58, testament: "new", chapters: 13 },
        { name: "James", cname: "雅各书", id: "james", bookNum: 59, testament: "new", chapters: 5 },
        { name: "1 Peter", cname: "彼得前书", id: "1peter", bookNum: 60, testament: "new", chapters: 5 },
        { name: "2 Peter", cname: "彼得后书", id: "2peter", bookNum: 61, testament: "new", chapters: 3 },
        { name: "1 John", cname: "约翰一书", id: "1john", bookNum: 62, testament: "new", chapters: 5 },
        { name: "2 John", cname: "约翰二书", id: "2john", bookNum: 63, testament: "new", chapters: 1 },
        { name: "3 John", cname: "约翰三书", id: "3john", bookNum: 64, testament: "new", chapters: 1 },
        { name: "Jude", cname: "犹大书", id: "jude", bookNum: 65, testament: "new", chapters: 1 },
        { name: "Revelation", cname: "启示录", id: "revelation", bookNum: 66, testament: "new", chapters: 22 }
      ]
    };

    const oldContainer = document.getElementById("old-testament");
    const newContainer = document.getElementById("new-testament");
    const heading = document.getElementById("heading");
    const subheading = document.getElementById("subheading");
    const versesContainer = document.getElementById("verses-container");
    const imageContainer = document.getElementById("chapter-image-container");
    const chapterImage = document.getElementById("chapter-image");
    const imageCaption = document.getElementById("image-caption");

    // Fetch chapter from bolls.life API (free, no authentication required)
    async function fetchChapter(translation, bookNum, chapter) {
      try {
        const url = `https://bolls.life/get-text/${translation}/${bookNum}/${chapter}/`;
        console.log('Fetching:', url);
        
        const response = await fetch(url);
        
        if (!response.ok) {
          throw new Error(`API request failed: ${response.status}`);
        }
        
        const data = await response.json();
        console.log('API response:', data);
        
        const verses = {};
        
        // Parse verses from bolls.life API response
        // Response is an array of verse objects: [{pk, verse, text}, ...]
        if (Array.isArray(data)) {
          data.forEach(verseObj => {
            let text = verseObj.text.trim();
            // Convert traditional to simplified for CUV if enabled
            if (translation === 'CUV' && useSimplifiedChinese) {
              text = toSimplified(text);
            }
            verses[verseObj.verse] = text;
          });
        }
        
        console.log('Parsed verses:', verses);
        return verses;
      } catch (error) {
        console.error('Failed to fetch chapter:', error);
        return {};
      }
    }

    // Comprehensive Traditional to Simplified Chinese character conversion (2000+ characters from standard mapping)
    function toSimplified(text) {
      const map = {'騃':'呆','愛':'爱','礙':'碍','靄':'蔼','絆':'绊','綁':'绑','幫':'帮','謗':'谤','雹':'雹','鴇':'鸨','賓':'宾','斃':'毙','筆':'笔','痺':'痹','蓽':'筚','潑':'泼','別':'别','彆':'别','鼈':'鳖','癟':'瘪','瀕':'濒','擯':'摈','撥':'拨','剝':'剥','飽':'饱','鈸':'钹','駁':'驳','薄':'薄','蔔':'卜','蔔':'卜','布':'布','財':'财','綵':'彩','採':'采','蠶':'蚕','慘':'惨','參':'参','燦':'灿','滄':'沧','傖':'伧','艙':'舱','蒼':'苍','操':'操','冊':'册','測':'测','側':'侧','岑':'岑','層':'层','詫':'诧','攙':'搀','讒':'谗','饞':'馋','蟬':'蝉','懺':'忏','嬋':'婵','禪':'禅','蕆':'蒇','鑱':'镵','滻':'浐','驏':'骣','諂':'谄','囅':'冁','闡':'阐','顫':'颤','嘗':'尝','長':'长','場':'场','萇':'苌','倀':'伥','鯧':'鲳','閶':'阊','敞':'敞','悵':'怅','暢':'畅','鈔':'钞','車':'车','徹':'彻','塵':'尘','陳':'陈','襯':'衬','稱':'称','撐':'撑','懲':'惩','誠':'诚','騁':'骋','癡':'痴','遲':'迟','馳':'驰','恥':'耻','齒':'齿','熾':'炽','飭':'饬','衝':'冲','寵':'宠','疇':'畴','儔':'俦','躊':'踌','籌':'筹','醜':'丑','櫥':'橱','芻':'刍','躕':'蹰','礎':'础','儲':'储','楚':'楚','觸':'触','處':'处','絀':'绌','懼':'惧','傳':'传','創':'创','瘡':'疮','炊':'炊','錘':'锤','純':'纯','脣':'唇','莼':'莼','蠢':'蠢','輟':'辍','齪':'龊','辭':'辞','慈':'慈','瓷':'瓷','詞':'词','賜':'赐','聰':'聪','蔥':'葱','驄':'骢','樅':'枞','蓯':'苁','從':'从','叢':'丛','湊':'凑','躥':'蹿','竄':'窜','摧':'摧','崔':'崔','催':'催','悴':'悴','璀':'璀','粹':'粹','淬':'淬','翠':'翠','村':'村','邨':'村','吋':'寸','撮':'撮','噠':'哒','達':'达','獃':'呆','單':'单','擔':'担','鄲':'郸','撣':'掸','簞':'箪','憚':'惮','癉':'瘅','殫':'殚','癲':'癫','黨':'党','擋':'挡','檔':'档','蕩':'荡','燾':'焘','盜':'盗','禱':'祷','導':'导','島':'岛','搗':'捣','燈':'灯','鄧':'邓','鐙':'镫','隄':'堤','敵':'敌','滌':'涤','締':'缔','諦':'谛','遞':'递','鏑':'镝','顛':'颠','點':'点','電':'电','墊':'垫','殿':'殿','澱':'淀','鈿':'钿','雕':'雕','凋':'凋','鵰':'雕','釣':'钓','調':'调','銚':'铫','貂':'貂','鯛':'鲷','疊':'叠','諜':'谍','鰈':'鲽','釘':'钉','頂':'顶','錠':'锭','訂':'订','碇':'碇','東':'东','鼕':'冬','董':'董','動':'动','棟':'栋','凍':'冻','洞':'洞','兜':'兜','鬥':'斗','竇':'窦','瀆':'渎','獨':'独','櫝':'椟','牘':'牍','犢':'犊','篤':'笃','鍍':'镀','鍛':'锻','緞':'缎','兌':'兑','隊':'队','對':'对','噸':'吨','頓':'顿','鈍':'钝','燉':'炖','奪':'夺','鐸':'铎','墮':'堕','惰':'惰','額':'额','訛':'讹','惡':'恶','餓':'饿','兒':'儿','爾':'尔','餌':'饵','貳':'贰','發':'发','罰':'罚','閥':'阀','琺':'珐','礬':'矾','範':'范','販':'贩','飯':'饭','訪':'访','紡':'纺','飛':'飞','廢':'废','墳':'坟','奮':'奋','糞':'粪','憤':'愤','豐':'丰','楓':'枫','鋒':'锋','風':'风','瘋':'疯','馮':'冯','縫':'缝','諷':'讽','鳳':'凤','膚':'肤','撫':'抚','輔':'辅','賦':'赋','復':'复','傅':'傅','負':'负','婦':'妇','縛':'缚','該':'该','鈣':'钙','蓋':'盖','幹':'干','趕':'赶','桿':'杆','稈':'秆','贛':'赣','岡':'冈','剛':'刚','鋼':'钢','綱':'纲','崗':'岗','槓':'杠','臯':'皋','鎬':'镐','誥':'诰','擱':'搁','鴿':'鸽','閣':'阁','個':'个','鉻':'铬','給':'给','亙':'亘','鞏':'巩','貢':'贡','溝':'沟','構':'构','購':'购','夠':'够','詬':'诟','緱':'缑','覯':'觏','轂':'毂','鈷':'钴','錮':'锢','顧':'顾','僱':'雇','颳':'刮','關':'关','觀':'观','館':'馆','慣':'惯','貫':'贯','廣':'广','規':'规','歸':'归','龜':'龟','閨':'闺','軌':'轨','詭':'诡','櫃':'柜','貴':'贵','劊':'刽','劌':'刿','滾':'滚','鍋':'锅','國':'国','過':'过','駭':'骇','韓':'韩','漢':'汉','號':'号','閡':'阂','鶴':'鹤','賀':'贺','橫':'横','轟':'轰','鴻':'鸿','紅':'红','閎':'闳','壺':'壶','滬':'沪','戶':'户','護':'护','滸':'浒','嘩':'哗','華':'华','畫':'画','劃':'划','話':'话','懷':'怀','壞':'坏','歡':'欢','環':'环','還':'还','緩':'缓','換':'换','喚':'唤','煥':'焕','瘓':'痪','渙':'涣','奐':'奂','黃':'黄','謊':'谎','鰉':'鳇','揮':'挥','輝':'辉','煇':'辉','麾':'麾','徽':'徽','諱':'讳','誨':'诲','賄':'贿','薈':'荟','燴':'烩','匯':'汇','彙':'汇','穢':'秽','諢':'诨','夥':'伙','貨':'货','獲':'获','禍':'祸','擊':'击','機':'机','積':'积','飢':'饥','饑':'饥','譏':'讥','雞':'鸡','績':'绩','緝':'缉','極':'极','輯':'辑','級':'级','擠':'挤','幾':'几','薊':'蓟','計':'计','記':'记','際':'际','繼':'继','紀':'纪','劑':'剂','濟':'济','擠':'挤','薺':'荠','寄':'寄','跡':'迹','霽':'霁','鰭':'鳍','殮':'殓','蘺':'蓠','驥':'骥','鯽':'鲫','夾':'夹','莢':'荚','頰':'颊','賈':'贾','鉀':'钾','價':'价','駕':'驾','殲':'歼','監':'监','堅':'坚','箋':'笺','間':'间','艱':'艰','緘':'缄','繭':'茧','檢':'检','鹼':'碱','減':'减','薦':'荐','檻':'槛','鑒':'鉴','踐':'践','賤':'贱','見':'见','鍵':'键','艦':'舰','劍':'剑','餞':'饯','漸':'渐','濺':'溅','澗':'涧','薑':'姜','將':'将','漿':'浆','韁':'缰','繮':'缰','槳':'桨','獎':'奖','講':'讲','醬':'酱','膠':'胶','澆':'浇','驕':'骄','嬌':'娇','攪':'搅','鉸':'铰','矯':'矫','僥':'侥','腳':'脚','餃':'饺','繳':'缴','絞':'绞','轎':'轿','較':'较','階':'阶','癤':'疖','節':'节','潔':'洁','結':'结','誡':'诫','屆':'届','緊':'紧','錦':'锦','僅':'仅','謹':'谨','進':'进','晉':'晋','燼':'烬','盡':'尽','勁':'劲','莖':'茎','涇':'泾','經':'经','頸':'颈','驚':'惊','鯨':'鲸','麗':'丽','穎':'颖','凈':'净','競':'竞','靜':'静','鏡':'镜','徑':'径','痙':'痉','靖':'靖','糾':'纠','廄':'厩','舊':'旧','臼':'臼','咎':'咎','僦':'僦','廄':'厩','鳩':'鸠','駒':'驹','鞠':'鞠','局':'局','咀':'咀','矩':'矩','舉':'举','莒':'莒','榘':'矩','齟':'龃','鋸':'锯','懼':'惧','捐':'捐','鵑':'鹃','娟':'娟','絹':'绢','雋':'隽','決':'决','絕':'绝','覺':'觉','軍':'军','鈞':'钧','皸':'皲','俊':'俊','郡':'郡','駿':'骏','喀':'喀','開':'开','凱':'凯','剴':'剀','慨':'慨','愾':'忾','愷':'恺','鎧':'铠','闓':'闿','墾':'垦','懇':'恳','摳':'抠','庫':'库','褲':'裤','嚳':'喾','虧':'亏','窺':'窥','潰':'溃','匱':'匮','饋':'馈','愧':'愧','餽':'馈','簣':'篑','蕢':'蒉','憒':'愦','聵':'聩','擴':'扩','闊':'阔','臘':'腊','蠟':'蜡','萊':'莱','來':'来','賴':'赖','崍':'崃','徠':'徕','淶':'涞','賚':'赉','睞':'睐','癩':'癞','藍':'蓝','欄':'栏','攔':'拦','籃':'篮','闌':'阑','蘭':'兰','瀾':'澜','讕':'谰','攬':'揽','覽':'览','纜':'缆','爛':'烂','濫':'滥','瑯':'琅','榔':'榔','稂':'稂','嘮':'唠','勞':'劳','癆':'痨','嶗':'崂','澇':'涝','樂':'乐','鰳':'鳓','類':'类','淚':'泪','壘':'垒','誄':'诔','縲':'缧','擂':'擂','累':'累','肋':'肋','羸':'羸','儡':'儡','嫘':'嫘','鐳':'镭','磊':'磊','蕾':'蕾','壘':'垒','纍':'累','離':'离','禮':'礼','鋰':'锂','裡':'里','裏':'里','鋰':'锂','釐':'厘','犛':'牦','蠣':'蛎','儷':'俪','勵':'励','嚦':'呖','瀝':'沥','癘':'疠','礪':'砺','糲':'粝','隸':'隶','蒞':'莅','蓮':'莲','聯':'联','簾':'帘','練':'练','煉':'炼','鍊':'炼','殮':'敛','斂':'敛','蘞':'蔹','臉':'脸','璉':'琏','奩':'奁','鏈':'链','殮':'殓','戀':'恋','煉':'炼','鏈':'链','良':'良','涼':'凉','樑':'梁','糧':'粮','諒':'谅','兩':'两','輛':'辆','諒':'谅','遼':'辽','療':'疗','繚':'缭','釕':'钌','鐐':'镣','鷯':'鹩','獵':'猎','臨':'临','鄰':'邻','燐':'磷','臨':'临','廩':'廪','藺':'蔺','賃':'赁','轔':'辚','凜':'凛','檁':'檩','轔':'辚','齡':'龄','靈':'灵','嶺':'岭','領':'领','餾':'馏','瀏':'浏','劉':'刘','鎦':'镏','飀':'飗','鏐':'镠','綹':'绺','鶹':'鹠','隴':'陇','壟':'垄','攏':'拢','隴':'陇','婁':'娄','嘍':'喽','簍':'篓','嶁':'嵝','摟':'搂','鏤':'镂','蔞':'蒌','髏':'髅','擼':'撸','爐':'炉','擄':'掳','鹵':'卤','虜':'虏','魯':'鲁','陸':'陆','錄':'录','壚':'垆','轆':'辘','鹿':'鹿','淥':'渌','祿':'禄','碌':'碌','賂':'赂','路':'路','潞':'潞','露':'露','轆':'辘','驢':'驴','呂':'吕','鋁':'铝','侶':'侣','旅':'旅','縷':'缕','櫚':'榈','慮':'虑','濾':'滤','礪':'砺','儷':'俪','鑢':'锉','巒':'峦','攣':'挛','孿':'孪','灤':'滦','臠':'脔','欒':'栾','鸞':'鸾','亂':'乱','掄':'抡','輪':'轮','倫':'伦','侖':'仑','淪':'沦','綸':'纶','論':'论','蘿':'萝','螺':'螺','邏':'逻','鑼':'锣','籮':'箩','騾':'骡','臝':'裸','犖':'荦','絡':'络','濼':'泺','洛':'洛','駱':'骆','絡':'络','媽':'妈','瑪':'玛','碼':'码','螞':'蚂','馬':'马','嗎':'吗','嬤':'嬷','罵':'骂','買':'买','麥':'麦','賣':'卖','邁':'迈','脈':'脉','瞞':'瞒','饅':'馒','蠻':'蛮','滿':'满','謾':'谩','縵':'缦','蟎':'螨','貓':'猫','錨':'锚','鉚':'铆','鍆':'镁','黴':'霉','沒':'没','鎂':'镁','門':'门','們':'们','萌':'萌','礞':'硵','懞':'蒙','錳':'锰','夢':'梦','瀰':'弥','謎':'谜','彌':'弥','覓':'觅','綿':'绵','緬':'缅','靦':'腼','麵':'面','廟':'庙','緲':'缈','滅':'灭','蔑':'蔑','憫':'悯','閔':'闵','緡':'缗','鳴':'鸣','銘':'铭','謬':'谬','謨':'谟','饃':'馍','摹':'摹','膜':'膜','謀':'谋','畝':'亩','墓':'墓','幕':'幕','納':'纳','難':'难','撓':'挠','腦':'脑','惱':'恼','鬧':'闹','訥':'讷','餒':'馁','擬':'拟','膩':'腻','攆':'撵','輦':'辇','黏':'黏','鳥':'鸟','捏':'捏','聶':'聂','齧':'啮','囁':'嗫','鑷':'镊','鎳':'镍','隉':'陧','寧':'宁','擰':'拧','濘':'泞','鈕':'钮','膿':'脓','儂':'侬','噥':'哝','瘧':'疟','諾':'诺','毆':'殴','嘔':'呕','漚':'沤','盤':'盘','龐':'庞','賠':'赔','噴':'喷','鵬':'鹏','騙':'骗','縹':'缥','頻':'频','貧':'贫','憑':'凭','評':'评','潑':'泼','頗':'颇','撲':'扑','鋪':'铺','譜':'谱','樸':'朴','瀑':'瀑','期':'期','欺':'欺','棲':'栖','淒':'凄','臍':'脐','騎':'骑','豈':'岂','啟':'启','綺':'绮','氣':'气','訖':'讫','棄':'弃','憩':'憩','遷':'迁','簽':'签','謙':'谦','錢':'钱','鉗':'钳','潛':'潜','黔':'黔','淺':'浅','譴':'谴','塹':'堑','歉':'歉','嗆':'呛','槍':'枪','嗆':'呛','牆':'墙','薔':'蔷','檣':'樯','強':'强','搶':'抢','鏹':'镪','鍬':'锹','僑':'侨','喬':'乔','橋':'桥','蕎':'荞','竅':'窍','誚':'诮','愜':'惬','竊':'窃','欽':'钦','親':'亲','寢':'寝','鋟':'锓','輕':'轻','傾':'倾','頃':'顷','慶':'庆','瓊':'琼','窮':'穷','煢':'茕','虯':'虬','區':'区','驅':'驱','軀':'躯','趨':'趋','齲':'龋','詘':'诎','麴':'曲','闕':'阙','卻':'却','鵲':'鹊','確':'确','闋':'阕','雀':'雀','裙':'裙','羣':'群','讓':'让','擾':'扰','繞':'绕','熱':'热','認':'认','紉':'纫','韌':'韧','軔':'轫','榮':'荣','絨':'绒','嶸':'嵘','蠑':'蝾','蝕':'蚀','銣':'铷','顬':'颥','縟':'缛','軟':'软','銳':'锐','閏':'闰','潤':'润','灑':'洒','薩':'萨','颯':'飒','賽':'赛','繖':'伞','毿':'毵','饊':'馓','喪':'丧','顙':'颡','騷':'骚','掃':'扫','繅':'缫','嫂':'嫂','澀':'涩','殺':'杀','紗':'纱','剎':'刹','篩':'筛','曬':'晒','刪':'删','閃':'闪','陝':'陕','擅':'擅','贍':'赡','繕':'缮','傷':'伤','殤':'殇','賞':'赏','燒':'烧','紹':'绍','賒':'赊','攝':'摄','懾':'慑','設':'设','審':'审','嬸':'婶','瀋':'沈','腎':'肾','滲':'渗','聲':'声','繩':'绳','勝':'胜','聖':'圣','師':'师','獅':'狮','濕':'湿','詩':'诗','時':'时','實':'实','蝕':'蚀','識':'识','駛':'驶','勢':'势','適':'适','視':'视','試':'试','釋':'释','飾':'饰','壽':'寿','獸':'兽','綬':'绶','書':'书','贖':'赎','屬':'属','術':'术','樹':'树','豎':'竖','數':'数','帥':'帅','閂':'闩','雙':'双','誰':'谁','稅':'税','順':'顺','說':'说','碩':'硕','爍':'烁','絲':'丝','飼':'饲','聳':'耸','慫':'怂','訟':'讼','誦':'诵','蘇':'苏','囌':'苏','謖':'谡','穌':'稣','雖':'虽','隨':'随','歲':'岁','孫':'孙','損':'损','筍':'笋','縮':'缩','鎖':'锁','瑣':'琐','獺':'獭','撻':'挞','闒':'阘','態':'态','鈦':'钛','臺':'台','檯':'台','颱':'台','態':'态','鰨':'鳎','壇':'坛','罈':'坛','曇':'昙','譚':'谭','談':'谈','歎':'叹','湯':'汤','糖':'糖','鏜':'镗','燙':'烫','濤':'涛','絛':'绦','縧':'绦','韜':'韬','鞀':'鼗','騰':'腾','謄':'誊','銻':'锑','緹':'缇','綈':'绨','題':'题','體':'体','屜':'屉','條':'条','齠':'龆','鰷':'鲦','調':'调','貼':'贴','鐵':'铁','廳':'厅','聽':'听','銅':'铜','統':'统','頭':'头','禿':'秃','圖':'图','塗':'涂','釷':'钍','團':'团','摶':'抟','頹':'颓','蛻':'蜕','脫':'脱','託':'托','馱':'驮','拖':'拖','拓':'拓','窪':'洼','媧':'娲','襪':'袜','彎':'弯','灣':'湾','頑':'顽','萬':'万','網':'网','韋':'韦','違':'违','圍':'围','為':'为','濰':'潍','維':'维','偽':'伪','衛':'卫','溫':'温','聞':'闻','紋':'纹','穩':'稳','撾':'挝','萵':'莴','臥':'卧','齷':'龌','嗚':'呜','鎢':'钨','烏':'乌','無':'无','蕪':'芜','誣':'诬','塢':'坞','霧':'雾','務':'务','誤':'误','犧':'牺','襲':'袭','習':'习','銑':'铣','洗':'洗','戲':'戏','細':'细','蝦':'虾','轄':'辖','峽':'峡','俠':'侠','狹':'狭','廈':'厦','嚇':'吓','鍁':'锨','癇':'痫','閑':'闲','鹹':'咸','賢':'贤','銜':'衔','顯':'显','險':'险','獻':'献','縣':'县','憲':'宪','線':'线','餡':'馅','羨':'羡','獫':'猃','蘚':'藓','峴':'岘','薟':'莶','鮮':'鲜','纖':'纤','鹹':'鹹','銜':'銜','鄉':'乡','薌':'芗','詳':'详','饗':'飨','驤':'骧','緗':'缃','鑲':'镶','廂':'厢','響':'响','嚮':'向','蕭':'萧','銷':'销','曉':'晓','嘯':'啸','嘵':'哓','瀟':'潇','瀟':'潇','囂':'嚣','寫':'写','洩':'泄','瀉':'泻','謝':'谢','褻':'亵','紲':'绁','鋅':'锌','釁':'衅','興':'兴','陘':'陉','滎':'荥','兇':'凶','洶':'汹','鏽':'锈','繡':'绣','饈':'馐','餼':'饩','須':'须','頊':'顼','續':'续','軒':'轩','懸':'悬','選':'选','癬':'癣','絢':'绚','諼':'谖','鉉':'铉','學':'学','謔':'谑','穴':'穴','壓':'压','鴉':'鸦','鴨':'鸭','啞':'哑','亞':'亚','訝':'讶','埡':'垭','婭':'娅','椏':'桠','煙':'烟','閹':'阉','醃':'腌','淹':'淹','嚴':'严','顏':'颜','閻':'阎','驗':'验','厭':'厌','硯':'砚','彥':'彦','諺':'谚','驗':'验','贗':'赝','釅':'酽','魘':'魇','厴':'厣','顔':'颜','颺':'飏','揚':'扬','陽':'阳','瘍':'疡','楊':'杨','煬':'炀','癢':'痒','養':'养','樣':'样','瑤':'瑶','搖':'摇','堯':'尧','遙':'遥','窯':'窑','謠':'谣','藥':'药','鑰':'钥','軺':'轺','鰩':'鳐','嶢':'峣','頁':'页','業':'业','葉':'叶','醫':'医','銥':'铱','頤':'颐','遺':'遗','儀':'仪','蟻':'蚁','藝':'艺','億':'亿','憶':'忆','義':'义','詣':'诣','議':'议','誼':'谊','譯':'译','異':'异','繹':'绎','薏':'薏','蔭':'荫','陰':'阴','隂':'阴','銀':'银','飲':'饮','隱':'隐','櫻':'樱','嬰':'婴','鷹':'鹰','應':'应','纓':'缨','瑩':'莹','鶯':'莺','塋':'茔','縈':'萦','蠅':'蝇','贏':'赢','穎':'颖','癭':'瘿','擁':'拥','傭':'佣','癰':'痈','踴':'踊','詠':'咏','湧':'涌','優':'优','憂':'忧','郵':'邮','鈾':'铀','猶':'犹','遊':'游','誘':'诱','輿':'舆','輿':'舆','魚':'鱼','漁':'渔','傴':'伛','與':'与','嶼':'屿','語':'语','獄':'狱','譽':'誉','預':'预','馭':'驭','鴛':'鸳','淵':'渊','轅':'辕','園':'园','員':'员','圓':'圆','緣':'缘','遠':'远','願':'愿','約':'约','躍':'跃','鑰':'钥','閱':'阅','雲':'云','鄖':'郧','勻':'匀','隕':'陨','運':'运','醞':'酝','韞':'韫','紜':'纭','鄆':'郓','雜':'杂','災':'灾','載':'载','暫':'暂','贊':'赞','贓':'赃','臟':'脏','鑿':'凿','棗':'枣','竈':'灶','責':'责','擇':'择','則':'则','澤':'泽','賊':'贼','譖':'谮','贈':'赠','閘':'闸','柵':'栅','詐':'诈','齋':'斋','債':'债','氈':'毡','盞':'盏','斬':'斩','輾':'辗','嶄':'崭','棧':'栈','戰':'战','綻':'绽','張':'张','脹':'胀','賬':'账','釗':'钊','詔':'诏','罩':'罩','肇':'肇','褶':'褶','這':'这','貞':'贞','針':'针','偵':'侦','診':'诊','鎮':'镇','陣':'阵','掙':'挣','猙':'狰','鉦':'钲','箏':'筝','蒸':'蒸','鋥':'锃','錚':'铮','崢':'峥','徵':'征','證':'证','鄭':'郑','諍':'诤','癥':'症','織':'织','執':'执','職':'职','紙':'纸','質':'质','製':'制','緻':'致','誌':'志','摯':'挚','擲':'掷','幟':'帜','躓':'踬','觶':'觯','鋕':'铚','銍':'铚','鐘':'钟','終':'终','種':'种','腫':'肿','塚':'冢','衆':'众','眾':'众','謅':'诌','軸':'轴','晝':'昼','驟':'骤','紂':'纣','豬':'猪','諸':'诸','誅':'诛','燭':'烛','囑':'嘱','矚':'瞩','貯':'贮','鑄':'铸','築':'筑','駐':'驻','註':'注','佇':'伫','苧':'苎','專':'专','磚':'砖','轉':'转','囀':'啭','賺':'赚','撰':'撰','妝':'妆','莊':'庄','裝':'装','壯':'壮','狀':'状','錐':'锥','墜':'坠','贅':'赘','諄':'谆','準':'准','濁':'浊','諑':'诼','鐲':'镯','資':'资','諮':'咨','緇':'缁','輜':'辎','貲':'赀','漬':'渍','蹤':'踪','總':'总','縱':'纵','鄒':'邹','詛':'诅','組':'组','鑽':'钻','纘':'缵','鱒':'鳟','樽':'樽','遵':'遵','鐏':'镞'};
      return text.split('').map(c => map[c] || c).join('');
    }

    function createBook(book) {
      const wrapper = document.createElement("div");
      wrapper.className = "book";

      const header = document.createElement("div");
      header.className = "book-header";
      header.innerHTML = `<span class="book-title">${book.cname} ${book.name}</span><span class="toggle">+</span>`;

      const list = document.createElement("div");
      list.className = "chapter-list";

      for (let i = 1; i <= book.chapters; i++) {
        const btn = document.createElement("div");
        btn.className = "chapter";
        btn.textContent = i;
        btn.addEventListener("click", e => {
          e.stopPropagation();
          loadChapter(book, i);
        });
        list.appendChild(btn);
      }

      header.addEventListener("click", () => {
        const open = list.classList.toggle("open");
        header.querySelector(".toggle").textContent = open ? "−" : "+";
      });

      wrapper.appendChild(header);
      wrapper.appendChild(list);
      return wrapper;
    }

    function buildSidebar() {
      bibleData.books.forEach(book => {
        const el = createBook(book);
        if (book.testament === "old") oldContainer.appendChild(el);
        else newContainer.appendChild(el);
      });
    }

    async function loadChapter(book, chapterNum) {
      currentBook = book;
      currentChapter = chapterNum;
      heading.textContent = `${book.name} ${chapterNum}`;
      updateBookmarkButton();
      updateNavigationButtons();
      
      // On mobile view, scroll to the chapter content (main element)
      // On desktop, scroll to top
      // Detect mobile by checking if body is in column layout
      const isMobile = window.getComputedStyle(document.body).flexDirection === 'column';
      
      if (isMobile) {
        // Mobile view - scroll to main content
        const mainElement = document.querySelector('main');
        if (mainElement) {
          mainElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
      } else {
        // Desktop view - scroll to top
        window.scrollTo({ top: 0, behavior: 'smooth' });
      }
      
      // Display chapter title if available
      const chapterTitle = getChapterTitle(book.name, chapterNum);
      if (chapterTitle) {
        subheading.textContent = `${chapterTitle.en} / ${chapterTitle.zh}`;
      } else {
        subheading.textContent = "Loading...";
      }
      
      versesContainer.innerHTML = '<div class="empty" style="grid-column: 1 / -1;">Loading...</div>';
      
      // Load chapter image
      loadChapterImage(book.name, chapterNum);

      try {
        const [cuvVerses, nivVerses] = await Promise.all([
          fetchChapter('CUV', book.bookNum, chapterNum),
          fetchChapter('NIV', book.bookNum, chapterNum)
        ]);

        // Keep chapter title if it exists, otherwise show translation info
        if (!chapterTitle) {
          subheading.textContent = "和合本 / NIV";
        }
        versesContainer.innerHTML = "";

        const allVerseNumbers = new Set([
          ...Object.keys(cuvVerses),
          ...Object.keys(nivVerses)
        ]);

        const sortedVerses = Array.from(allVerseNumbers).sort((a, b) => {
          const numA = parseInt(a) || 0;
          const numB = parseInt(b) || 0;
          return numA - numB;
        });

        sortedVerses.forEach(v => {
          const row = document.createElement("div");
          row.className = "verse-row";
          row.innerHTML = `
            <div class="v-num">${chapterNum}:${v}</div>
            <div class="v-text">${cuvVerses[v] || ""}</div>
            <div class="v-text">${nivVerses[v] || ""}</div>
          `;
          versesContainer.appendChild(row);
        });

        if (sortedVerses.length === 0) {
          versesContainer.innerHTML = '<div class="empty" style="grid-column: 1 / -1;">Chapter not found</div>';
        }
      } catch (error) {
        subheading.textContent = "Error loading chapter";
        versesContainer.innerHTML = '<div class="empty" style="grid-column: 1 / -1;">Failed to load</div>';
      }
    }

    // Load representative image for the chapter
    async function loadChapterImage(bookName, chapterNum) {
      // Show container immediately
      imageContainer.style.display = 'block';
      imageCaption.textContent = `${bookName} Chapter ${chapterNum}`;
      
      // Use Pexels API (free) for more relevant biblical imagery
      const chapterImages = {
        // Genesis
        'Genesis-1': 'https://images.pexels.com/photos/414612/pexels-photo-414612.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        'Genesis-2': 'https://images.pexels.com/photos/1179229/pexels-photo-1179229.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        'Genesis-3': 'https://images.pexels.com/photos/208518/pexels-photo-208518.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        'Genesis-6': 'https://images.pexels.com/photos/1118873/pexels-photo-1118873.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        'Genesis-7': 'https://images.pexels.com/photos/1034650/pexels-photo-1034650.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        'Genesis-11': 'https://images.pexels.com/photos/2034892/pexels-photo-2034892.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        'Genesis-22': 'https://images.pexels.com/photos/417173/pexels-photo-417173.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        // Exodus
        'Exodus-2': 'https://images.pexels.com/photos/1557652/pexels-photo-1557652.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        'Exodus-3': 'https://images.pexels.com/photos/266487/pexels-photo-266487.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        'Exodus-7': 'https://images.pexels.com/photos/3075993/pexels-photo-3075993.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        'Exodus-14': 'https://images.pexels.com/photos/1619654/pexels-photo-1619654.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        'Exodus-20': 'https://images.pexels.com/photos/1261427/pexels-photo-1261427.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        // Psalms
        'Psalms-1': 'https://images.pexels.com/photos/268533/pexels-photo-268533.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        'Psalms-23': 'https://images.pexels.com/photos/422218/pexels-photo-422218.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        'Psalms-91': 'https://images.pexels.com/photos/1266810/pexels-photo-1266810.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        'Psalms-100': 'https://images.pexels.com/photos/208326/pexels-photo-208326.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        // Proverbs
        'Proverbs-3': 'https://images.pexels.com/photos/256417/pexels-photo-256417.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        'Proverbs-31': 'https://images.pexels.com/photos/4065876/pexels-photo-4065876.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        // Matthew
        'Matthew-1': 'https://images.pexels.com/photos/1701324/pexels-photo-1701324.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        'Matthew-2': 'https://images.pexels.com/photos/956981/milky-way-starry-sky-night-sky-star-956981.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        'Matthew-5': 'https://images.pexels.com/photos/1557958/pexels-photo-1557958.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        'Matthew-6': 'https://images.pexels.com/photos/256559/pexels-photo-256559.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        'Matthew-14': 'https://images.pexels.com/photos/1001682/pexels-photo-1001682.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        'Matthew-26': 'https://images.pexels.com/photos/65175/pexels-photo-65175.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        'Matthew-27': 'https://images.pexels.com/photos/208421/pexels-photo-208421.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        'Matthew-28': 'https://images.pexels.com/photos/326012/pexels-photo-326012.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        // Mark
        'Mark-1': 'https://images.pexels.com/photos/35577/africa-animal-fur-cat.jpg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        'Mark-16': 'https://images.pexels.com/photos/127905/pexels-photo-127905.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        // Luke
        'Luke-1': 'https://images.pexels.com/photos/236111/pexels-photo-236111.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        'Luke-2': 'https://images.pexels.com/photos/372882/pexels-photo-372882.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        'Luke-15': 'https://images.pexels.com/photos/1615776/pexels-photo-1615776.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        'Luke-24': 'https://images.pexels.com/photos/2387873/pexels-photo-2387873.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        // John
        'John-1': 'https://images.pexels.com/photos/1089455/pexels-photo-1089455.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        'John-3': 'https://images.pexels.com/photos/933054/pexels-photo-933054.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        'John-8': 'https://images.pexels.com/photos/1567069/pexels-photo-1567069.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        'John-11': 'https://images.pexels.com/photos/3075993/pexels-photo-3075993.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        'John-13': 'https://images.pexels.com/photos/374703/pexels-photo-374703.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        'John-14': 'https://images.pexels.com/photos/2387873/pexels-photo-2387873.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        'John-19': 'https://images.pexels.com/photos/236111/pexels-photo-236111.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        'John-20': 'https://images.pexels.com/photos/531756/pexels-photo-531756.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        'John-21': 'https://images.pexels.com/photos/237018/pexels-photo-237018.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        // Acts
        'Acts-1': 'https://images.pexels.com/photos/3791466/pexels-photo-3791466.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        'Acts-2': 'https://images.pexels.com/photos/266487/pexels-photo-266487.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        'Acts-9': 'https://images.pexels.com/photos/1578750/pexels-photo-1578750.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        'Acts-16': 'https://images.pexels.com/photos/277593/pexels-photo-277593.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        // Romans
        'Romans-8': 'https://images.pexels.com/photos/206359/pexels-photo-206359.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        'Romans-12': 'https://images.pexels.com/photos/1405528/pexels-photo-1405528.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        // 1 Corinthians
        '1 Corinthians-13': 'https://images.pexels.com/photos/66997/pexels-photo-66997.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        // Ephesians
        'Ephesians-6': 'https://images.pexels.com/photos/163431/fencing-fighting-world-war-armor-163431.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        // Revelation
        'Revelation-1': 'https://images.pexels.com/photos/220072/pexels-photo-220072.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        'Revelation-4': 'https://images.pexels.com/photos/1166990/pexels-photo-1166990.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        'Revelation-12': 'https://images.pexels.com/photos/326012/pexels-photo-326012.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        'Revelation-21': 'https://images.pexels.com/photos/208745/pexels-photo-208745.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
        'Revelation-22': 'https://images.pexels.com/photos/1557958/pexels-photo-1557958.jpeg?auto=compress&cs=tinysrgb&w=800&h=500&fit=crop',
      };
      
      const key = `${bookName}-${chapterNum}`;
      
      if (chapterImages[key]) {
        // Use curated image
        chapterImage.src = chapterImages[key];
      } else {
        // Create a custom gradient image with chapter info
        const canvas = document.createElement('canvas');
        canvas.width = 800;
        canvas.height = 500;
        const ctx = canvas.getContext('2d');
        
        // Create varied gradients based on book
        const gradients = [
          ['#667eea', '#764ba2'], // purple
          ['#f093fb', '#f5576c'], // pink
          ['#4facfe', '#00f2fe'], // blue
          ['#43e97b', '#38f9d7'], // green
          ['#fa709a', '#fee140'], // orange
          ['#30cfd0', '#330867'], // teal
          ['#a8edea', '#fed6e3'], // pastel
          ['#ff9a56', '#ff6a88'], // warm
        ];
        
        const hash = bookName.split('').reduce((acc, char) => acc + char.charCodeAt(0), 0);
        const gradientPair = gradients[hash % gradients.length];
        
        const gradient = ctx.createLinearGradient(0, 0, 800, 500);
        gradient.addColorStop(0, gradientPair[0]);
        gradient.addColorStop(1, gradientPair[1]);
        ctx.fillStyle = gradient;
        ctx.fillRect(0, 0, 800, 500);
        
        // Add decorative elements
        ctx.fillStyle = 'rgba(255, 255, 255, 0.1)';
        ctx.beginPath();
        ctx.arc(600, 100, 150, 0, Math.PI * 2);
        ctx.fill();
        ctx.beginPath();
        ctx.arc(200, 400, 100, 0, Math.PI * 2);
        ctx.fill();
        
        // Add text
        ctx.fillStyle = 'white';
        ctx.shadowColor = 'rgba(0, 0, 0, 0.3)';
        ctx.shadowBlur = 10;
        ctx.font = 'bold 56px Arial';
        ctx.textAlign = 'center';
        ctx.fillText(bookName, 400, 220);
        ctx.font = '42px Arial';
        ctx.fillText(`Chapter ${chapterNum}`, 400, 280);
        
        chapterImage.src = canvas.toDataURL();
      }
    }

    buildSidebar();
    renderBookmarks();
  </script>
</body>
</html>
